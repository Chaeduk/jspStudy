## 웹 애플리케이션

웹 서비스를 제공하기 위해 만들어진 일종의 프로그램을 말한다. 웹 서비스는 여러 HTML 파일로 구성되어 있고, HTML 파일에는 화면을 구성하는 이미지 파일이나 플래시 애니메이션, css 및 js 파일 등 부가적인 콘텐츠가 포함되어 있다. 따라서 웹 애플리케이션은 이들 자원을 모두 포함한 개념으로 볼 수 있다. 물론 JSP와 같은 프로그램 요소들도 웹 애플리케이션의 구성요소에 포함된다.

## 웹 애플리케이션 컨텐츠 구성(리소스)

![컨텐츠 구성](./01.PNG)

- 동적 콘텐츠 : 서블릿, JSP와 같은 동적 콘텐츠는 단순한 텍스트가 아닌 프로그램으로서, 서비스 제공자의 의도나 사용자 및 상황에 따라 다른 내용을 제공하기 위한 콘텐츠이다.

- 정적 콘텐츠 : HTML이 정적 콘텐츠의 대표적인 유형이다. HTML 파일에 작성된 내용은 파일 내용을 수정하기 전까지는 모든 사용자들에게 동일한 내용을 보여준다

보조 콘텐츠 : 정적 콘텐츠에 부분적으로 동적인 서비스를 제공하기 위한 스타일시트나 자바스크립트 등과 같은 보조 콘텐츠도 포함될 수 있다.

## 웹 애플리케이션 디렉토리 구성

웹 애플리케이션에 대한 디렉터리 규칙은 Java EE 스펙을 따른다.

- 컨텍스트 루드(Context Root) : 일명 홈디렉토리로 해당 애플리케이션의 메인 디렉터리가 된다. 대부분의 정적 콘텐츠가 위치하는 곳이다.

- WEB-INF : 웹 어플리케이션의 배포 서술자인 web.xml 파일을 비롯해 애플리케이션에서 참조할 각종 XML, DTD, XSD, 그리고 태그 라이브러리 관련 파일(TLD, 태그 파일) 등이 위치한다.
  - WEB-INF/lib : 애플리케이션에서 사용할 공통 라이브러리가 위치하는 곳이다. 보통 .jar 형태로 위치하며, JDBC 드라이버 등 서드 파티에서 제공하는 클래스 라이브러리를 참조하려고 사용하는 디렉터리다.
  - WEB_INF/classes : 서블릿, 빈즈 클래스, 유틸 클래스의 컴파일된 클래스 파일이 위치하는 곳이다. 해당 소스의 패키지 구조에 따라 하위 폴더로 관리된다.
    -WEB_INF/src : 빈즈 클래스나 서블릿 소스 파일을 관리하기 위한 디렉터리이다.

## 컨테이너와 개발환경

컨테이너는 웹 애플리케이션을 실행하기 위한 환경으로, 사용자의 요청을 받아들이고 처리하는 역할을 수행하는 일종의 서버 프로그램을 말한다.

## 웹 애플리케이션의 배포

작성된 웹 애플리케이션을 컨테이너에서 실행하려면 배포라는 작업이 필요하다.

-배포 방법

- Tomcat Directory에 직접 파일로 배포하는 방법
- Tomcat Manager를 이용한 방법
- Tomcat Client Deployer를 이용하는 방법

## Tomcat Manager

톰캣에 기본적으로 포함되어 있는 웹 기반의 관리도구다. 비교적 쉽게 웹 애플리케이션을 배포하거나 관리할 수 있으며, 관리자에 대한 접근 권한 등을 설정해서 어느 정도의 보안 문제도 해결할 수 있다.

- 이클립스에 개발용으로 등록된 톰캣은 관리자 모드를 사용할 수 없고 윈도우에 설치된 톰캣을 통해서만 관리자 모드를 사용할 수 있다.

## 배포 서술자

배포 서술자(DD)는 Java EE 스펙으로 웹 애플리케이션의 기본적인 설정을 위해 작성하는 파일로, 보통은 WEB-INF/web.xml을 말한다.

- 배포서술자의 사용 목적
  - 컨테이너 호환성 유지 : 웹 애플리케이션의 배포와 관련된 정보를 제공함으로써, 서로 다른 컨테이너에서도 별도의 설정 없이 동일한 애플리케이션을 운영할 수 있다.
  - 효율적인 애플리케이션 유지보수 : 특정 서블릿 혹은 전체 애플리케이션에서 공유하기 위한 초기화 매개변수를 설정할 수 있으므로 애플리케이션 프로그램 간에 데이터를 쉽게 공유할 수 있다.
  - 유연한 애플리케이션 운영 : 서블릿 매핑 등 다양한 정보를 텍스트 기반으로 설정할 수 있으므로, 서비스 운영 중 프로그램을 수정하지 않고도 애플리케이션의 동작을 조정할 수 있다.

## web.xml 세부 구조

- web.xml 파일은 XML 형식으로 작성된 일반 텍스트 파일이다.
- web.xml 설정은 웹 애플리케이션 실행과 관련이 있고, 설정이 잘못될 경우 컨테이너에서 해당 웹 애플리케이션을 제대로 실행하지 못하는 문제가 발생할 수도 있으니 설정에 주의한다.

| 구성요소          | 설명                                                                                            |
| ----------------- | ----------------------------------------------------------------------------------------------- |
| context-param     | 서블릿 컨텍스트의 초기 매개변수를 설정한다. 설정된 내용은 모든 서블릿과 JSP에서 참조할 수 있다. |
| filter            | 필터 서블릿을 등록하는 부분이다.                                                                |
| filter-mapping    | 필터 서블릿의 url 매핑을 지정하는 부분이다.                                                     |
| listener          | 리스너 서블릿을 등록하는 부분이다.                                                              |
| servlet           | 서블릿을 등록하는 부분이다.                                                                     |
| servlet-mapping   | 서블릿의 URL 매핑을 지정하는 부분이다.                                                          |
| welcome-file-list | index.html, index.jsp 등 초기 로딩 파일을 지정하는 부분이다.                                    |

## 톰캣 사용자 등록

톰캣 사용자 등록은 tomcat-users.xml 파일에서 한다. 톰캣 설치 시 등록한 관리자 계정도 tomcat-users.xml에 등록되어 있다.

## role

role이란 특정 사용자에게 부여할 역할로 사용자별로 접근할 수 있는 리소스를 통제하려고 여러 권한을 그룹으로 묶어 놓은 것이다.

## 로그 파일 관리

로그 파일은 서버의 모든 운영기록, 애플리케이션 오류 등을 파일 형태로 저장하는 것으로 시스템에 문제가 발생했거나 애플리케이션 오류 추적, 웹 서버에 대한 사용자 요청 분석 등 다양한 목적으로 활용된다.

## 웹 애플리케이션 개발

웹 애플리케이션은 개발 -> 패키징 -> 배포 및 실행 -> 관리의 과정으로 개발되고 운영된다.

## 웹 애플리케이션 패키징

웹 애플리케이션의 패키징은 이클립스에서 제공하는 Export 기능을 사용하며 패키징된 파일은 웹 애플리케이션 아카이브 포맷인 .war 파일로 만들어 진다.

## 배포와 실행

웹 애플리케이션의 배포, 즉 설치하는 방법에는 컨테이너가 종료된 상태에서 디렉터리 구조에 WAR 파일을 직접 복사하거나 압축을 해제하는 방법, 실행 중인 서버에 동적으로 설치하는 방법이 있다.

- 실행 중인 서버에 설치하는 경우 해당 컨테이너에서 제공하는 배포 툴이 있어야 한다. 톰캣의 경우 앞서 살펴본 Tomcat Manager라는 툴을 제공하고 있다.

## 관리

설치된 웹 애플리케이션은 상황에 따라 잠시 운영을 중단 하거나 재시작하는 경우가 발생한다. 이때 Tomcat Manager에서 해당 작업을 수행할 수 있다.

## 웹 애플리케이션 아키텍처

- Client-Server 구조에서 Web Server 기반 구조로 진화<br>
  (물리층인 티어(Tier)와 논리층인 레이어(Layer)로 구분)

![아키텍처](./02.PNG)

## 웹 어플리케이션 서버 레이어

단방향 3개 층(Layer)으로 구성된다.

![레이어](./03.PNG)

## 프리젠테이션 층의 역할

- 사용자 인터페이스와 컨트롤러를 제공하는 역할
- 컨트롤러는 사용자 인터페이스를 통해 사용자의 입력을 받아 적합한 로직을 호출하고, 그 결과를 사용자 인터페이스로 변환하는 작업

## 모델 1 방식

- JSP만 사용하여 개발하거나 Java bean을 포함하여 개발하는 방식을 의미
- JSP에 뷰와 비즈니스 로직이 혼재되어 복잡도가 높음 - 유지보수 어려움

![model1](./04.PNG)

## 모델 2 방식(MVC 패턴 적용)

- 모델(Model) : 뷰에 필요한 비즈니스 영역의 로직을 처리
- 뷰(View) : 비즈니스 영역에 대한 프레젠테이션 뷰(결과 화면)를 담당
- 컨트롤러(Controller) : 사용자의 입력 처리와 화면의 흐름 제어를 담당

## REST 아키텍처

- HTTp 프로토롤 메서드인 (GET, POST, PUT, DELETE)를 이용하여 HTTP 서버와 상호작용하며 웹 어플리케이션 서버는 다양한 형태(JSON, XML, RSS 등)로 정보를 반환하는 방식

- 웹 프로토롤(HTTP)을 활용하는 Resource 중심의 연동 인터페이스 구조

- 만들어지는 데이터를 그대로 제공하기 위한 단순성으로 최소한의 품질과 대용량 처리를 위한 성능, 편의성에 유리

- XML 형식보다는 JSON 형식 사용이 증가하는 추세

## JSON(JavaScript Object Notation)

- 브라우저와 서버 통신을 위해 텍스트-기반의 비동기 데이터 교환 형식
- application/json, .json
