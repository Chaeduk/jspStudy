## JSP와 서블릿

- JSP는 HTML 내의 자바 코드를 삽입하여 동적 페이지를 생성하는 스크립트 언어
- 서블릿은 자바를 이용한 동적 페이지를 생성하는 서버 프로그래밍 기술

## JSP 특징

- JSP 또는 다른 서블릿 간의 데이터를 쉽게 공유할 수 있다.
- 자바의 모든 기능과 빈즈(Beans)라는 자바 컴포넌트를 사용할 수 있다. -커스텀 태그를 만들어 사용할 수 있으며, JSTL과 같은 태그 라이브러리를 이용할 수 있다.

## JSP 태그

- 스크립트 태그(Script) : 자바 코드를 넣어 프로그램이 수행하는 기능을 구현
- 디렉티브 태그(Directive) : JSP 페이지에 대한 정보를 컨테이너에 제공
- 액션 태그(Action) : XML 형태의 태그로 JSP 페이지 간 제어

## 스크립트 태그

JSP 페이지를 서블릿 클래스로 변환할 때 컨테이너(톰캣)는 자바 코드가 삽입되어 있는 스크립트 태그를 처리하고 나머지는 HTML 코드나 일반 텍스트로 간주

| 스크립트 태그 | 형식     | 설명                                                |
| ------------- | -------- | --------------------------------------------------- |
| 선언문        | <%!...%> | 자바 변수나 메소드를 정의                           |
| 스크립트릿    | <%...%>  | 자바 로직 코드를 작성                               |
| 표현식        | <%=...%> | 변수, 계산식, 메소드 호출 결과를 문자열 형태로 출력 |

## 선언문 태그

- 메서드나 전역 변수를 선언하기 위한 구문
- 서블릿 프로그램으로 변환될 때 \_jspService() 메소드 외부에 배치됨
- 각 행이 세미콜론으로 끝나야 함

## 스크립트릿 태그

- JSP 문서 내에서 자바 코드를 기술하는 부분
- 서블릿 프로그램으로 변환될 때 \_jspService() 메소드 내부에 배치
- 각 행이 세미콜론으로 끝나야 함
- 메서드를 정의할 수 없다

## 표현식 태그

- 간단한 테이터 출력이나 메서드 호출등에 이용
- 기본 데이터 타입, 자바 객체 타입 사용 가능
- 메서드 호출, 변수 출력, 사칙연산 및 문자열 결합 등이 가능

## JSP 전체 동작 과정

html은 해당 파일을 웹 브라우저로 보내주는 것에 비해 jsp는 서버에서 프로그램 실행 결과를 html로 변형하여 웹 브라우저로 전달

1. 웹 브라우저에서 url을 입력한다
2. dns 서버로부터 입력한 url을 변환한 ip 주소를 받는다
3. 받은 ip 주소의 웹서버 ~~번 포트에 jsp 페이지를 요청한다
4. 웹 서버가 요청 내용을 분석하고 서블릿 컨테이너에 요청을 넘겨 처리한다
5. 화면에 보일 내용을 html 문서 형태로 웹 브라우저에 전송한다

## 서블릿 컨테이너

JSP, 서블릿의 실행 환경을 제공 : 웹 어플리케이션 서버(톰캣)

## JSP 처리 과정

- JSP는 서블릿 컨테이너에 의해 서블릿 자바 소스로 변환되고, 다시 클래스 파일로 컴파일됨
- A.jsp -> A_jsp.java -> A_jsp.class

1. 웹 서버로부터 jsp에 대한 사용자 요청이 컨테이너로 전달된다
2. 요청 jsp에 대한 서블릿이 존재하면 다음 단계로 진행하고, 존재하지 않을 경우 jsp를 .java 파일로 변환한 다음 .class 파일로 컴파일 한다
3. 컴파일된 서블릿 클래스를 컨테이너의 메모리에 적재하고 실행한다.
4. db 처리 혹은 별도의 기능을 위한 클래스 호출 등이 있다면 실행하고 결과를 취합해 html 형태로 구성한다
5. html 형태의 결과를 웹 서버를 경유해 사용자 브라우저에 전달한다

<div align=center>

![jsp](./03.png)

</div>

## jspService()

- request, response를 파라미터로 받고 있다
- request, response는 내장 객체 중 하나로 사용자 요청을 처리하는데 필요한 기본적인 요소들이다

(내장객체 : 서블릿으로 변환된 jsp에서 별도의 선언 없이 접근 가능한 객체)

### JSP 파일에서 개발자가 작성한 코드는 모두 out.write() 형태로 처리된다
